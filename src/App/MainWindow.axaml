<?xml version="1.0" encoding="utf-8"?>
<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="using:Diffracta"
        xmlns:gfx="using:Diffracta.Graphics"
        x:Class="Diffracta.MainWindow"
        x:DataType="local:MainWindow"
        Width="1000" Height="700" Title="Diffracta (v/0.1)">
  
  <Window.Resources>
    <!-- Custom Thumb Template for Square Thumb -->
    <ControlTheme x:Key="SquareThumbTheme" TargetType="Thumb">
      <Setter Property="Template">
        <ControlTemplate>
          <Border Background="#dedede"
                  BorderBrush="#d3d3d3"
                  BorderThickness="1"
                  CornerRadius="0"
                  Width="18"
                  Height="12"/>
        </ControlTemplate>
      </Setter>
    </ControlTheme>
  </Window.Resources>
  
  <Window.Styles>
    <Style Selector="TextBox#LogTextBox">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Focusable" Value="False"/>
      <Setter Property="Cursor" Value="Arrow"/>
    </Style>

    <!-- Simple Horizontal Slider Style -->
    <Style Selector="Slider:horizontal">
      <Setter Property="MinWidth" Value="40" />
      <Setter Property="Height" Value="40" />
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="Background" Value="#333333" />
      <Setter Property="HorizontalAlignment" Value="Left"/>
      
      

      
      <Style Selector="^ Track">
        <Style Selector="^ RepeatButton Border">
          <Setter Property="CornerRadius" Value="0"/>
          <Setter Property="Height" Value="15"/>
          <Setter Property="BorderBrush" Value="#000000" />
          <Setter Property="BorderThickness" Value="1" />
        </Style>
      </Style>
                      
      <Style Selector="^ Thumb">
        <Setter Property="Theme" Value="{StaticResource SquareThumbTheme}"/>
      </Style>
    </Style>
    


    
    <!-- Button styling - light grey background with black text -->
    <Style Selector="Button">
      <Setter Property="Background" Value="#d3d3d3"/>
      <Setter Property="Foreground" Value="Black"/>
      <Setter Property="BorderThickness" Value="1"/>
    </Style>
  </Window.Styles>
  
  <Grid Background="#1e1e1e">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>
    
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>
    
    <!-- Simple Sidebar -->
    <Border Grid.Row="0" Grid.RowSpan="3" Grid.Column="0" 
            Width="50" 
            Background="#1e1e1e"
            BorderBrush="#555555"
            BorderThickness="0,0,1,0">
        <StackPanel Orientation="Vertical" Spacing="8" Margin="8,4,8,8">
            <!-- Button 1: Controls -->
            <Button x:Name="Page1Button" Width="34" Height="34" 
                    Background="Transparent" 
                    BorderThickness="0"
                    CornerRadius="4">
                <Border Width="24" Height="24" 
                        Background="#d3d3d3" 
                        CornerRadius="2" 
                        Opacity="0.5"/>
                <Button.Styles>
                    <Style Selector="Button:pointerover">
                        <Setter Property="Background" Value="#2d2d2d"/>
                    </Style>
                </Button.Styles>
            </Button>
            
            <!-- Button 2: Tools -->
            <Button x:Name="Page2Button" Width="34" Height="34" 
                    Background="Transparent" 
                    BorderThickness="0"
                    CornerRadius="4">
                <Border Width="24" Height="24" 
                        Background="#d3d3d3" 
                        CornerRadius="2" 
                        Opacity="0.5"/>
                <Button.Styles>
                    <Style Selector="Button:pointerover">
                        <Setter Property="Background" Value="#2d2d2d"/>
                    </Style>
                </Button.Styles>
            </Button>
            
            <!-- Button 3: Settings -->
            <Button x:Name="Page3Button" Width="34" Height="34" 
                    Background="Transparent" 
                    BorderThickness="0"
                    CornerRadius="4">
                <Border Width="24" Height="24" 
                        Background="#d3d3d3" 
                        CornerRadius="2" 
                        Opacity="0.5"/>
                <Button.Styles>
                    <Style Selector="Button:pointerover">
                        <Setter Property="Background" Value="#2d2d2d"/>
                    </Style>
                </Button.Styles>
            </Button>

            <!-- Button 4: Help -->
            <Button x:Name="Page4Button" Width="34" Height="34" 
                    Background="Transparent" 
                    BorderThickness="0"
                    CornerRadius="4">
                <Border Width="24" Height="24" 
                        Background="#d3d3d3" 
                        CornerRadius="2" 
                        Opacity="0.5"/>
                <Button.Styles>
                    <Style Selector="Button:pointerover">
                        <Setter Property="Background" Value="#2d2d2d"/>
                    </Style>
                </Button.Styles>
            </Button>
        </StackPanel>
    </Border>
    
    <!-- Top toolbar -->
    <StackPanel Orientation="Horizontal" Spacing="8" Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2" Margin="8" Background="#1e1e1e">
      <Button x:Name="PerformanceButton" Content="Performance" Margin="0,0,0,0" />
    </StackPanel>
    
    <!-- Left Panel (Page-based Navigation) - Full Height -->
    <Grid Grid.Row="1" Grid.RowSpan="2" Grid.Column="1" x:Name="ControlsPanel" Background="#2d2d2d">
        <ContentControl x:Name="PageContentControl">
            <!-- Page 1: Controls (Default) -->
            <Grid x:Name="ControlsPage">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <StackPanel Orientation="Vertical" Spacing="8" Margin="8,4" Grid.Row="0">
                    <!-- Tempo Clock Controls -->
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Button x:Name="TempoButton" 
                                Content="{Binding TempoButtonText}" 
                                Width="100" 
                                Click="OnTempoButtonPressed"
                                Background="{Binding TempoButtonBackground}"
                                Foreground="Black"
                                BorderBrush="Black"
                                BorderThickness="1"
                                CornerRadius="4">
                            <Button.Styles>
                                <Style Selector="Button:pointerover">
                                    <Setter Property="Background" Value="#e0e0e0"/>
                                </Style>
                            </Button.Styles>
                        </Button>
                        <Button x:Name="ResetButton" 
                                Content="Reset" 
                                Width="60" 
                                Click="OnResetButtonClicked"
                                Background="#d3d3d3"
                                Foreground="Black"
                                BorderBrush="Black"
                                BorderThickness="1"
                                CornerRadius="4"/>
                        <TextBlock x:Name="TempoDisplay" 
                                   Text="{Binding Tempo.TimeDisplay}" 
                                   Foreground="White" 
                                   FontSize="14" 
                                   VerticalAlignment="Center"
                                   MinWidth="80"/>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock Text="Selected Shader:" Foreground="White" VerticalAlignment="Center"/>
                        <ComboBox x:Name="ShaderPicker" Width="200">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding}" Foreground="White"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </StackPanel>
                </StackPanel>
                
                <ScrollViewer Grid.Row="1" Margin="8,0,8,8">
                    <StackPanel Spacing="12">
                        <Button x:Name="LoadShaderButton" Content="Load Shader" Width="200"/>
                        
                        <StackPanel Spacing="4">
                            <TextBlock Text="Post-Process VFX" Foreground="White" FontSize="14"/>
                            
                            <!-- POST-PROCESS VFX CONTROL GROUP -->
                            <Border BorderBrush="Black" BorderThickness="1" Padding="4">
                                <StackPanel Spacing="4">
                                    
                                    <!-- SLOT 1: Saturation -->
                                    <StackPanel Orientation="Horizontal" Spacing="4">
                                        <TextBlock Text="Slot 1: Saturation" Foreground="White" FontSize="14" VerticalAlignment="Center"/>
                                        <Button x:Name="Slot1Toggle" 
                                                Content="ON" 
                                                Width="40" 
                                                Height="24"
                                                Click="OnSlot1ToggleClicked"
                                                Background="#4CAF50"
                                                Foreground="White"
                                                FontSize="10"
                                                BorderBrush="Black"
                                                BorderThickness="1"
                                                CornerRadius="2"/>
                                    </StackPanel>
                                    <Border BorderBrush="Black" BorderThickness="1" CornerRadius="4" ClipToBounds="True" Height="36">
                                        <StackPanel Orientation="Horizontal" Spacing="0" Background="#2D2D2D">
                                            <Border BorderBrush="Black" BorderThickness="1" Padding="4">
                                                <Slider x:Name="Slot1Slider" Minimum="0" Maximum="2" Value="1" Width="200" 
                                                        ValueChanged="OnSlot1ValueChanged" Padding="0,-4,0,0"/>
                                            </Border>
                                            <Border BorderBrush="Black" BorderThickness="1" Padding="4">
                                                <TextBlock x:Name="Slot1Value" Text="1.00" Foreground="#888888" FontSize="14" Width="60" Padding="4"/>
                                            </Border>
                                        </StackPanel>
                                    </Border>

                                    <!-- SLOT 2: Ping-Pong Delay -->
                                    <StackPanel Orientation="Horizontal" Spacing="4">
                                        <TextBlock Text="Slot 2: Ping-Pong Delay" Foreground="White" FontSize="14" VerticalAlignment="Center"/>
                                        <Button x:Name="Slot2Toggle" 
                                                Content="OFF" 
                                                Width="40" 
                                                Height="24"
                                                Click="OnSlot2ToggleClicked"
                                                Background="#F44336"
                                                Foreground="White"
                                                FontSize="10"
                                                BorderBrush="Black"
                                                BorderThickness="1"
                                                CornerRadius="2"/>
                                    </StackPanel>
                                    <Border BorderBrush="Black" BorderThickness="1" CornerRadius="4" ClipToBounds="True" Height="36">
                                        <StackPanel Orientation="Horizontal" Spacing="0" Background="#2D2D2D">
                                            <Border BorderBrush="Black" BorderThickness="1" Padding="4">
                                                <Slider x:Name="Slot2Slider" Minimum="0" Maximum="1" Value="0" Width="200" 
                                                        ValueChanged="OnSlot2ValueChanged" Padding="0,-4,0,0"/>
                                            </Border>
                                            <Border BorderBrush="Black" BorderThickness="1" Padding="4">
                                                <TextBlock x:Name="Slot2Value" Text="0.00" Foreground="#888888" FontSize="14" Width="60" Padding="4"/>
                                            </Border>
                                        </StackPanel>
                                    </Border>

                                    <!-- SLOT 3: Empty -->
                                    <StackPanel Orientation="Horizontal" Spacing="4">
                                        <TextBlock Text="Slot 3: Empty" Foreground="#888888" FontSize="14" VerticalAlignment="Center"/>
                                        <Button x:Name="Slot3Toggle" 
                                                Content="OFF" 
                                                Width="40" 
                                                Height="24"
                                                Click="OnSlot3ToggleClicked"
                                                Background="#F44336"
                                                Foreground="White"
                                                FontSize="10"
                                                BorderBrush="Black"
                                                BorderThickness="1"
                                                CornerRadius="2"/>
                                    </StackPanel>
                                    <Border BorderBrush="Black" BorderThickness="1" CornerRadius="4" ClipToBounds="True" Height="36">
                                        <StackPanel Orientation="Horizontal" Spacing="0" Background="#2D2D2D">
                                            <Border BorderBrush="Black" BorderThickness="1" Padding="4">
                                                <Slider x:Name="Slot3Slider" Minimum="0" Maximum="1" Value="0" Width="200" 
                                                        ValueChanged="OnSlot3ValueChanged" Padding="0,-4,0,0"/>
                                            </Border>
                                            <Border BorderBrush="Black" BorderThickness="1" Padding="4">
                                                <TextBlock x:Name="Slot3Value" Text="0.00" Foreground="#888888" FontSize="14" Width="60" Padding="4"/>
                                            </Border>
                                        </StackPanel>
                                    </Border>

                                    <!-- SLOT 4: Empty -->
                                    <StackPanel Orientation="Horizontal" Spacing="4">
                                        <TextBlock Text="Slot 4: Empty" Foreground="#888888" FontSize="14" VerticalAlignment="Center"/>
                                        <Button x:Name="Slot4Toggle" 
                                                Content="OFF" 
                                                Width="40" 
                                                Height="24"
                                                Click="OnSlot4ToggleClicked"
                                                Background="#F44336"
                                                Foreground="White"
                                                FontSize="10"
                                                BorderBrush="Black"
                                                BorderThickness="1"
                                                CornerRadius="2"/>
                                    </StackPanel>
                                    <Border BorderBrush="Black" BorderThickness="1" CornerRadius="4" ClipToBounds="True" Height="36">
                                        <StackPanel Orientation="Horizontal" Spacing="0" Background="#2D2D2D">
                                            <Border BorderBrush="Black" BorderThickness="1" Padding="4">
                                                <Slider x:Name="Slot4Slider" Minimum="0" Maximum="1" Value="0" Width="200" 
                                                        ValueChanged="OnSlot4ValueChanged" Padding="0,-4,0,0"/>
                                            </Border>
                                            <Border BorderBrush="Black" BorderThickness="1" Padding="4">
                                                <TextBlock x:Name="Slot4Value" Text="0.00" Foreground="#888888" FontSize="14" Width="60" Padding="4"/>
                                            </Border>
                                        </StackPanel>
                                    </Border>

                                    <!-- SLOT 5: Empty -->
                                    <StackPanel Orientation="Horizontal" Spacing="4">
                                        <TextBlock Text="Slot 5: Empty" Foreground="#888888" FontSize="14" VerticalAlignment="Center"/>
                                        <Button x:Name="Slot5Toggle" 
                                                Content="OFF" 
                                                Width="40" 
                                                Height="24"
                                                Click="OnSlot5ToggleClicked"
                                                Background="#F44336"
                                                Foreground="White"
                                                FontSize="10"
                                                BorderBrush="Black"
                                                BorderThickness="1"
                                                CornerRadius="2"/>
                                    </StackPanel>
                                    <Border BorderBrush="Black" BorderThickness="1" CornerRadius="4" ClipToBounds="True" Height="36">
                                        <StackPanel Orientation="Horizontal" Spacing="0" Background="#2D2D2D">
                                            <Border BorderBrush="Black" BorderThickness="1" Padding="4">
                                                <Slider x:Name="Slot5Slider" Minimum="0" Maximum="1" Value="0" Width="200" 
                                                        ValueChanged="OnSlot5ValueChanged" Padding="0,-4,0,0"/>
                                            </Border>
                                            <Border BorderBrush="Black" BorderThickness="1" Padding="4">
                                                <TextBlock x:Name="Slot5Value" Text="0.00" Foreground="#888888" FontSize="14" Width="60" Padding="4"/>
                                            </Border>
                                        </StackPanel>
                                    </Border>

                                </StackPanel>
                            </Border>
                        </StackPanel>
                        
                        <!-- Custom Touchpad Button -->
                        <StackPanel Spacing="4">
                            <Button x:Name="TouchpadButton" 
                                    Width="200" 
                                    Height="40" 
                                    Click="OnTouchpadClicked"
                                    Background="#d3d3d3"
                                    CornerRadius="4"
                                    Content="">

                                <TextBlock Text="Touchpad" Foreground="Black" FontSize="12" VerticalAlignment="Center" HorizontalAlignment="Center" />
                                <Button.Styles>
                                
                                    <Style Selector="Button:pointerover">
                                        <Setter Property="Background" Value="#e0e0e0"/>
                                    </Style>
                                    <Style Selector="Button:pressed">
                                        <Setter Property="Background" Value="#ff8c00"/>
                                    </Style>
                                </Button.Styles>
                            </Button>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </ContentControl>
    </Grid>
    
    <!-- Vertical splitter between left and right columns -->
    <GridSplitter Grid.Row="1" Grid.RowSpan="2" Grid.Column="1" Width="3" Background="#555555" HorizontalAlignment="Right" x:Name="VerticalSplitter"/>
    
    <!-- Top Right: Shader Surface -->
    <gfx:ShaderSurface x:Name="Surface" Grid.Row="1" Grid.Column="2" Margin="0" Focusable="True" ClipToBounds="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
    
    <!-- Horizontal splitter between top and bottom rows (right side only) -->
    <GridSplitter Grid.Row="1" Grid.Column="2" Height="3" Background="#555555" VerticalAlignment="Bottom" x:Name="HorizontalSplitter"/>
    
    
    <!-- Bottom Right: Tabbed Panel -->
    <Grid Grid.Row="2" Grid.Column="2" x:Name="BottomRightPanel" Background="#2d2d2d">
        <TabControl Background="#2d2d2d" Foreground="White">
            <TabItem Header="Log" Background="#2d2d2d" FontSize="14" Foreground="White">
                <Grid Background="#1e1e1e">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Orientation="Horizontal" Spacing="8" Margin="8,4" Grid.Row="0">
                        <TextBlock Text="Debug Log" Foreground="White" VerticalAlignment="Center"/>
                        <Button x:Name="ClearLogButton" Content="Clear" Width="60"/>
                        <Button x:Name="CopyLogButton" Content="Copy" Width="60"/>
                    </StackPanel>
                    
                    <ScrollViewer Grid.Row="1" Margin="8,0,8,8" x:Name="LogScrollViewer">
                        <TextBlock x:Name="LogTextBox" 
                                   Background="Transparent" 
                                   Foreground="White" 
                                   TextWrapping="Wrap"
                                   FontFamily="Consolas"
                                   FontSize="12"/>
                    </ScrollViewer>
                </Grid>
            </TabItem>
            
            <TabItem Header="Info" Background="#2d2d2d" FontSize="14" Foreground="White">
                <ScrollViewer Margin="8">
                    <StackPanel Spacing="8">
                        <TextBlock Text="Shader Information" Foreground="White" FontSize="14"/>
                        <TextBlock x:Name="ShaderInfoText" Text="No shader loaded" Foreground="#cccccc" FontSize="14" TextWrapping="Wrap"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
        </TabControl>
    </Grid>
  </Grid>
</Window>
