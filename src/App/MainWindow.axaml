<?xml version="1.0" encoding="utf-8"?>
<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="using:Diffracta"
        xmlns:gfx="using:Diffracta.Graphics"
        x:Class="Diffracta.MainWindow"
        x:DataType="local:MainWindow"
        Width="1920" Height="1080" Title="Diffracta (v0.1) 1080p MainWindow">
  


  <Window.Resources>
    <!-- Custom Thumb Template for Square Thumb -->
    <ControlTheme x:Key="SquareThumbTheme" TargetType="Thumb">
      <Setter Property="Template">
        <ControlTemplate>
          <Border Background="#888888"
                  BorderBrush="#666666"
                  BorderThickness="1"
                  CornerRadius="0"
                  Width="18"
                  Height="32"/>
        </ControlTemplate>
      </Setter>
    </ControlTheme>
  </Window.Resources>
  
  <Window.Styles>
    <StyleInclude Source="avares://Diffracta/Utils_Slider.axaml"/>
    
    <Style Selector="TextBox#LogTextBox">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="Focusable" Value="False"/>
      <Setter Property="Cursor" Value="Arrow"/>
    </Style>
    
    
    <!-- Button styling - light grey background with black text -->
    <Style Selector="Button">
      <Setter Property="Background" Value="#d3d3d3"/>
      <Setter Property="Foreground" Value="Black"/>
      <Setter Property="BorderThickness" Value="1"/>
    </Style>

    <Style Selector="Menu">
        <Setter Property="Height" Value="26"/>
        <Setter Property="Background" Value="#2d2d2d"/>
    </Style>
    
    

    <Style Selector="MenuItem">
        <Setter Property="Foreground" Value="White"/>
        <Setter Property="Background" Value="#2d2d2d"/>
        <Setter Property="BorderBrush" Value="#2d2d2d"/>
        <Setter Property="BorderThickness" Value="0"/>
    </Style>
    
    <!-- MenuItem hover - keep white text, grey background -->
    <Style Selector="MenuItem:pointerover">
      <Setter Property="Foreground" Value="White"/>
      <Setter Property="Background" Value="#3d3d3d"/>
    </Style>
    
    <!-- MenuItem popup/dropdown container - grey background -->
    <Style Selector="MenuItem > Popup > Border">
        <Setter Property="Background" Value="#2d2d2d"/>
        <Setter Property="BorderBrush" Value="#2d2d2d"/>
        <Setter Property="BorderThickness" Value="1"/>
    </Style>
    
    <!-- Menu panel container - grey background -->
    <Style Selector="Menu > Panel">
        <Setter Property="Background" Value="#2d2d2d"/>
    </Style>
    
    <!-- ComboBox styling - grey background, white text -->
    <Style Selector="ComboBox">
      <Setter Property="Background" Value="#2d2d2d"/>
      <Setter Property="Foreground" Value="White"/>
    </Style>
    
    <!-- ComboBox items -->
    <Style Selector="ComboBoxItem">
      <Setter Property="Background" Value="#2d2d2d"/>
      <Setter Property="Foreground" Value="White"/>
    </Style>
    
    <!-- TabItem styling - reduce header height and remove underline -->
    <Style Selector="TabItem">
      <Setter Property="MinHeight" Value="26"/>
      <Setter Property="Padding" Value="8,4"/>
      <Setter Property="BorderThickness" Value="0"/>
    </Style>
    <!-- Remove underline from selected tab -->
    <Style Selector="TabItem:selected /template/ Border#PART_SelectedPipe">
        <Setter Property="IsVisible" Value="false"/>
    </Style>

  </Window.Styles>
  
  <Grid Background="#1e1e1e">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="3*"/>
    </Grid.RowDefinitions>
    
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="3*"/>
        <ColumnDefinition Width="*"/>
    </Grid.ColumnDefinitions>
    
    <!-- Menu Bar -->
    <Menu x:Name="MenuBar" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" Background="#2d2d2d" Foreground="White">
        <MenuItem Header="_File">
            <MenuItem Header="_New" />
            <Separator />
            <MenuItem Header="E_xit" />
        </MenuItem>
        <MenuItem Header="_View">
            <MenuItem Header="Toggle Performance Mode" />
            <Separator />
            <MenuItem Header="_Child Window" x:Name="ChildWindowMenuItem" />
        </MenuItem>
        <MenuItem Header="_Help">
            <MenuItem Header="_About" />
            <MenuItem Header="Documentation" />
        </MenuItem>
    </Menu>
    
    <!-- Top toolbar -->
    <StackPanel x:Name="TopToolbar" Orientation="Horizontal" Spacing="8" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="3" Margin="8" Background="#1e1e1e">
      <Button x:Name="PerformanceButton" Content="Performance" Margin="0,0,0,0" />
      <Button x:Name="LogsButton" Content="Logs" Margin="0,0,0,0" />
    </StackPanel>
    
    
    
    <!-- Simple Sidebar -->
    <Border x:Name="LeftSidebar" Grid.Row="2" Grid.RowSpan="2" Grid.Column="0" 
            Width="50" 
            Background="#1e1e1e"
            BorderBrush="#555555"
            BorderThickness="0,0,1,0">
        <StackPanel Orientation="Vertical" Spacing="8" Margin="8,4,8,8">
            <!-- Button 1: Controls -->
            <Button x:Name="Page1Button" Width="34" Height="34" 
                    Background="Transparent" 
                    BorderThickness="0"
                    CornerRadius="4">
                <Border Width="24" Height="24" 
                        Background="#d3d3d3" 
                        CornerRadius="2" 
                        Opacity="0.5"/>
                <Button.Styles>
                    <Style Selector="Button:pointerover">
                        <Setter Property="Background" Value="#2d2d2d"/>
                    </Style>
                </Button.Styles>
            </Button>
            
            <!-- Button 2: Tools -->
            <Button x:Name="Page2Button" Width="34" Height="34" 
                    Background="Transparent" 
                    BorderThickness="0"
                    CornerRadius="4">
                <Border Width="24" Height="24" 
                        Background="#d3d3d3" 
                        CornerRadius="2" 
                        Opacity="0.5"/>
                <Button.Styles>
                    <Style Selector="Button:pointerover">
                        <Setter Property="Background" Value="#2d2d2d"/>
                    </Style>
                </Button.Styles>
            </Button>
            
            <!-- Button 3: Settings -->
            <Button x:Name="Page3Button" Width="34" Height="34" 
                    Background="Transparent" 
                    BorderThickness="0"
                    CornerRadius="4">
                <Border Width="24" Height="24" 
                        Background="#d3d3d3" 
                        CornerRadius="2" 
                        Opacity="0.5"/>
                <Button.Styles>
                    <Style Selector="Button:pointerover">
                        <Setter Property="Background" Value="#2d2d2d"/>
                    </Style>
                </Button.Styles>
            </Button>

            <!-- Button 4: Help -->
            <Button x:Name="Page4Button" Width="34" Height="34" 
                    Background="Transparent" 
                    BorderThickness="0"
                    CornerRadius="4">
                <Border Width="24" Height="24" 
                        Background="#d3d3d3" 
                        CornerRadius="2" 
                        Opacity="0.5"/>
                <Button.Styles>
                    <Style Selector="Button:pointerover">
                        <Setter Property="Background" Value="#2d2d2d"/>
                    </Style>
                </Button.Styles>
            </Button>
        </StackPanel>
    </Border>
    
    
    
    <!-- Left Panel (Page-based Navigation) - Full Height -->
    <Grid Grid.Row="2" Grid.RowSpan="2" Grid.Column="1" x:Name="ControlsPanel" Background="#2d2d2d">
        <ContentControl x:Name="PageContentControl">
            <!-- Page content will be swapped dynamically -->
        </ContentControl>
    </Grid>
    
    <!-- Vertical splitter between left and right columns -->
    <GridSplitter Grid.Row="2" Grid.RowSpan="2" Grid.Column="1" Width="3" Background="#555555" HorizontalAlignment="Right" x:Name="VerticalSplitter"/>
    
    <!-- Top Right: Shader Surface -->
    <gfx:ShaderSurface x:Name="Surface" Grid.Row="2" Grid.Column="2" Margin="0" Focusable="True" ClipToBounds="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
    
    <!-- Horizontal splitter between top and bottom rows (right side only) -->
    <GridSplitter Grid.Row="2" Grid.Column="2" Height="3" Background="#555555" VerticalAlignment="Bottom" x:Name="HorizontalSplitter"/>
    
    
    <!-- Bottom Right: Tabbed Panel -->
    <Grid Grid.Row="3" Grid.Column="2" x:Name="BottomRightPanel" Background="#2d2d2d">
    
        <TabControl Background="#2d2d2d" Foreground="White">

            <TabItem Header="Global" Background="#1e1e1e" FontSize="14" Foreground="White"> 

                <Border BorderBrush="Pink" BorderThickness="1" Background="#2d2d2d" Margin="-10, 0, -10, 0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">

                    <ScrollViewer Margin="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <StackPanel Spacing="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <!-- Shader Nodes Visualization - Processing Layers -->
                            <Border BorderBrush="#555555" BorderThickness="1" Background="#1e1e1e" Margin="0,0,0,8" Padding="8">
                                <StackPanel Spacing="4">
                                    <!-- Layer 0: Main Shader (Global Texture) -->
                                    <Border x:Name="Node0Border" 
                                            BorderBrush="#666666" 
                                            BorderThickness="1" 
                                            Background="#2d2d2d" 
                                            CornerRadius="2" 
                                            Padding="6,4"
                                            IsVisible="True">
                                        <StackPanel Spacing="4">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <Border x:Name="Node0RectButton"
                                                        BorderBrush="Transparent"
                                                        BorderThickness="0"
                                                        Padding="0"
                                                        Cursor="Hand"
                                                        IsHitTestVisible="True">
                                                    <Rectangle x:Name="Node0Rect" 
                                                               Width="12" 
                                                               Height="12" 
                                                               Fill="#666666" 
                                                               VerticalAlignment="Center"
                                                               HorizontalAlignment="Center"
                                                               IsHitTestVisible="False"/>
                                                </Border>
                                                <TextBlock x:Name="Node0Text" 
                                                           Text="Label 0: Global Texture" 
                                                           Foreground="White" 
                                                           FontSize="12" 
                                                           VerticalAlignment="Center"/>
                                            </StackPanel>
                                            <!-- Subrow: Slider and Value (shown when active) -->
                                            <Border x:Name="Node0Subrow"
                                                    Margin="20,0,0,0"
                                                    IsVisible="False">
                                                <StackPanel Orientation="Horizontal" Spacing="8">
                                                    <Slider x:Name="Node0Slider"
                                                            Minimum="0"
                                                            Maximum="1"
                                                            Value="0"
                                                            Width="200"
                                                            Height="32"
                                                            VerticalAlignment="Center"/>
                                                    <Border BorderBrush="Black"
                                                            BorderThickness="1"
                                                            CornerRadius="0"
                                                            Padding="4,2">
                                                        <TextBlock x:Name="Node0Value"
                                                                   Text="0.00"
                                                                   Foreground="#888888"
                                                                   FontSize="12"
                                                                   Width="50"
                                                                   TextAlignment="Center"
                                                                   VerticalAlignment="Center"/>
                                                    </Border>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </Border>
                                    
                                    <!-- Arrow from Layer 0 to Layer 1 -->
                                    <Path x:Name="Node1Arrow" 
                                          Data="M 0,0 L 0,8 M -3,5 L 0,8 L 3,5" 
                                          Stroke="#666666" 
                                          StrokeThickness="1.5" 
                                          StrokeJoin="Round"
                                          HorizontalAlignment="Center"
                                          Margin="0,2,0,2"
                                          IsVisible="False"/>
                                    
                                    <!-- Layer 1: Post-Process Node 0 -->
                                    <Border x:Name="Node1Border" 
                                            BorderBrush="#666666" 
                                            BorderThickness="1" 
                                            Background="#2d2d2d" 
                                            CornerRadius="2" 
                                            Padding="6,4"
                                            IsVisible="True">
                                        <StackPanel Spacing="4">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <Border x:Name="Node1RectButton"
                                                        BorderBrush="Transparent"
                                                        BorderThickness="0"
                                                        Background="Transparent"
                                                        Padding="2"
                                                        Cursor="Hand"
                                                        IsHitTestVisible="True">
                                                    <Rectangle x:Name="Node1Rect" 
                                                               Width="12" 
                                                               Height="12" 
                                                               Fill="#666666" 
                                                               VerticalAlignment="Center"
                                                               HorizontalAlignment="Center"
                                                               IsHitTestVisible="False"/>
                                                </Border>
                                                <TextBlock x:Name="Node1Text" 
                                                           Text="Label 1: Post-Process" 
                                                           Foreground="White" 
                                                           FontSize="12" 
                                                           VerticalAlignment="Center"/>
                                            </StackPanel>
                                            <!-- Subrow: Slider and Value (shown when active) -->
                                            <Border x:Name="Node1Subrow"
                                                    Margin="20,0,0,0"
                                                    IsVisible="False">
                                                <StackPanel Orientation="Horizontal" Spacing="8">
                                                    <Slider x:Name="Node1Slider"
                                                            Minimum="0"
                                                            Maximum="1"
                                                            Value="0"
                                                            Width="200"
                                                            Height="32"
                                                            VerticalAlignment="Center"/>
                                                    <Border BorderBrush="Black"
                                                            BorderThickness="1"
                                                            CornerRadius="0"
                                                            Padding="4,2">
                                                        <TextBlock x:Name="Node1Value"
                                                                   Text="0.00"
                                                                   Foreground="#888888"
                                                                   FontSize="12"
                                                                   Width="50"
                                                                   TextAlignment="Center"
                                                                   VerticalAlignment="Center"/>
                                                    </Border>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </Border>
                                    

                                    
                                    <!-- Layer 2: Post-Process Node 1 -->
                                    <Border x:Name="Node2Border" 
                                            BorderBrush="#666666" 
                                            BorderThickness="1" 
                                            Background="#2d2d2d" 
                                            CornerRadius="2" 
                                            Padding="6,4"
                                            IsVisible="True">
                                        <StackPanel Spacing="4">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <Border x:Name="Node2RectButton"
                                                        BorderBrush="Transparent"
                                                        BorderThickness="0"
                                                        Background="Transparent"
                                                        Padding="2"
                                                        Cursor="Hand"
                                                        IsHitTestVisible="True">
                                                    <Rectangle x:Name="Node2Rect" 
                                                               Width="12" 
                                                               Height="12" 
                                                               Fill="#666666" 
                                                               VerticalAlignment="Center"
                                                               HorizontalAlignment="Center"
                                                               IsHitTestVisible="False"/>
                                                </Border>
                                                <TextBlock x:Name="Node2Text" 
                                                           Text="Label 2: Post-Process" 
                                                           Foreground="White" 
                                                           FontSize="12" 
                                                           VerticalAlignment="Center"/>
                                            </StackPanel>
                                            <!-- Subrow: Slider and Value (shown when active) -->
                                            <Border x:Name="Node2Subrow"
                                                    Margin="20,0,0,0"
                                                    IsVisible="False">
                                                <StackPanel Orientation="Horizontal" Spacing="8">
                                                    <Slider x:Name="Node2Slider"
                                                            Minimum="0"
                                                            Maximum="1"
                                                            Value="0"
                                                            Width="200"
                                                            Height="32"
                                                            VerticalAlignment="Center"/>
                                                    <Border BorderBrush="Black"
                                                            BorderThickness="1"
                                                            CornerRadius="0"
                                                            Padding="4,2">
                                                        <TextBlock x:Name="Node2Value"
                                                                   Text="0.00"
                                                                   Foreground="#888888"
                                                                   FontSize="12"
                                                                   Width="50"
                                                                   TextAlignment="Center"
                                                                   VerticalAlignment="Center"/>
                                                    </Border>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </Border>
                                    
                                    <!-- Layer 3: Post-Process Node 2 -->
                                    <Border x:Name="Node3Border" 
                                            BorderBrush="#666666" 
                                            BorderThickness="1" 
                                            Background="#2d2d2d" 
                                            CornerRadius="2" 
                                            Padding="6,4"
                                            IsVisible="True">
                                        <StackPanel Spacing="4">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <Border x:Name="Node3RectButton"
                                                        BorderBrush="Transparent"
                                                        BorderThickness="0"
                                                        Background="Transparent"
                                                        Padding="2"
                                                        Cursor="Hand"
                                                        IsHitTestVisible="True">
                                                    <Rectangle x:Name="Node3Rect" 
                                                               Width="12" 
                                                               Height="12" 
                                                               Fill="#666666" 
                                                               VerticalAlignment="Center"
                                                               HorizontalAlignment="Center"
                                                               IsHitTestVisible="False"/>
                                                </Border>
                                                <TextBlock x:Name="Node3Text" 
                                                           Text="Label 3: Post-Process" 
                                                           Foreground="White" 
                                                           FontSize="12" 
                                                           VerticalAlignment="Center"/>
                                            </StackPanel>
                                            <!-- Subrow: Slider and Value (shown when active) -->
                                            <Border x:Name="Node3Subrow"
                                                    Margin="20,0,0,0"
                                                    IsVisible="False">
                                                <StackPanel Orientation="Horizontal" Spacing="8">
                                                    <Slider x:Name="Node3Slider"
                                                            Minimum="0"
                                                            Maximum="1"
                                                            Value="0"
                                                            Width="200"
                                                            Height="32"
                                                            VerticalAlignment="Center"/>
                                                    <Border BorderBrush="Black"
                                                            BorderThickness="1"
                                                            CornerRadius="0"
                                                            Padding="4,2">
                                                        <TextBlock x:Name="Node3Value"
                                                                   Text="0.00"
                                                                   Foreground="#888888"
                                                                   FontSize="12"
                                                                   Width="50"
                                                                   TextAlignment="Center"
                                                                   VerticalAlignment="Center"/>
                                                    </Border>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </Border>


                                    
                                    <!-- Layer 4: Post-Process Node 3 -->
                                    <Border x:Name="Node4Border" 
                                            BorderBrush="#666666" 
                                            BorderThickness="1" 
                                            Background="#2d2d2d" 
                                            CornerRadius="2" 
                                            Padding="6,4"
                                            IsVisible="True">
                                        <StackPanel Spacing="4">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <Border x:Name="Node4RectButton"
                                                        BorderBrush="Transparent"
                                                        BorderThickness="0"
                                                        Background="Transparent"
                                                        Padding="2"
                                                        Cursor="Hand"
                                                        IsHitTestVisible="True">
                                                    <Rectangle x:Name="Node4Rect" 
                                                               Width="12" 
                                                               Height="12" 
                                                               Fill="#666666" 
                                                               VerticalAlignment="Center"
                                                               HorizontalAlignment="Center"
                                                               IsHitTestVisible="False"/>
                                                </Border>
                                                <TextBlock x:Name="Node4Text" 
                                                           Text="Label 4: Post-Process" 
                                                           Foreground="White" 
                                                           FontSize="12" 
                                                           VerticalAlignment="Center"/>
                                            </StackPanel>
                                            <!-- Subrow: Slider and Value (shown when active) -->
                                            <Border x:Name="Node4Subrow"
                                                    Margin="20,0,0,0"
                                                    IsVisible="False">
                                                <StackPanel Orientation="Horizontal" Spacing="8">
                                                    <Slider x:Name="Node4Slider"
                                                            Minimum="0"
                                                            Maximum="1"
                                                            Value="0"
                                                            Width="200"
                                                            Height="32"
                                                            VerticalAlignment="Center"/>
                                                    <Border BorderBrush="Black"
                                                            BorderThickness="1"
                                                            CornerRadius="0"
                                                            Padding="4,2">
                                                        <TextBlock x:Name="Node4Value"
                                                                   Text="0.00"
                                                                   Foreground="#888888"
                                                                   FontSize="12"
                                                                   Width="50"
                                                                   TextAlignment="Center"
                                                                   VerticalAlignment="Center"/>
                                                    </Border>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </Border>
                                    

                                    
                                    <!-- Layer 5: Post-Process Node 4 -->
                                    <Border x:Name="Node5Border" 
                                            BorderBrush="#666666" 
                                            BorderThickness="1" 
                                            Background="#2d2d2d" 
                                            CornerRadius="2" 
                                            Padding="6,4"
                                            IsVisible="True">
                                        <StackPanel Spacing="4">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <Border x:Name="Node5RectButton"
                                                        BorderBrush="Transparent"
                                                        BorderThickness="0"
                                                        Background="Transparent"
                                                        Padding="2"
                                                        Cursor="Hand"
                                                        IsHitTestVisible="True">
                                                    <Rectangle x:Name="Node5Rect" 
                                                               Width="12" 
                                                               Height="12" 
                                                               Fill="#666666" 
                                                               VerticalAlignment="Center"
                                                               HorizontalAlignment="Center"
                                                               IsHitTestVisible="False"/>
                                                </Border>
                                                <TextBlock x:Name="Node5Text" 
                                                           Text="Label 5: Post-Process" 
                                                           Foreground="White" 
                                                           FontSize="12" 
                                                           VerticalAlignment="Center"/>
                                            </StackPanel>
                                            <!-- Subrow: Slider and Value (shown when active) -->
                                            <Border x:Name="Node5Subrow"
                                                    Margin="20,0,0,0"
                                                    IsVisible="False">
                                                <StackPanel Orientation="Horizontal" Spacing="8">
                                                    <Slider x:Name="Node5Slider"
                                                            Minimum="0"
                                                            Maximum="1"
                                                            Value="0"
                                                            Width="200"
                                                            Height="32"
                                                            VerticalAlignment="Center"/>
                                                    <Border BorderBrush="Black"
                                                            BorderThickness="1"
                                                            CornerRadius="0"
                                                            Padding="4,2">
                                                        <TextBlock x:Name="Node5Value"
                                                                   Text="0.00"
                                                                   Foreground="#888888"
                                                                   FontSize="12"
                                                                   Width="50"
                                                                   TextAlignment="Center"
                                                                   VerticalAlignment="Center"/>
                                                    </Border>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </Border>
                                    
                                    <!-- Arrow from Layer 5 to Layer 6 -->
                                    <Path x:Name="Node6Arrow" 
                                          Data="M 0,0 L 0,8 M -3,5 L 0,8 L 3,5" 
                                          Stroke="#666666" 
                                          StrokeThickness="1.5" 
                                          StrokeJoin="Round"
                                          HorizontalAlignment="Center"
                                          Margin="0,2,0,2"
                                          IsVisible="False"/>
                                    
                                    <!-- Layer 6: Blackout MASTER Node -->
                                    <Border x:Name="Node6Border" 
                                            BorderBrush="#666666" 
                                            BorderThickness="1" 
                                            Background="#2d2d2d" 
                                            CornerRadius="2" 
                                            Padding="6,4"
                                            IsVisible="True">
                                        <StackPanel Spacing="4">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <Border x:Name="Node6RectButton"
                                                        BorderBrush="Transparent"
                                                        BorderThickness="0"
                                                        Background="Transparent"
                                                        Padding="2"
                                                        Cursor="Hand"
                                                        IsHitTestVisible="True">
                                                    <Rectangle x:Name="Node6Rect" 
                                                               Width="12" 
                                                               Height="12" 
                                                               Fill="#666666" 
                                                               VerticalAlignment="Center"
                                                               HorizontalAlignment="Center"
                                                               IsHitTestVisible="False"/>
                                                </Border>
                                                <TextBlock x:Name="Node6Text" 
                                                           Text="Label 6: Blackout (MASTER)" 
                                                           Foreground="White" 
                                                           FontSize="12" 
                                                           VerticalAlignment="Center"/>
                                            </StackPanel>
                                            <!-- Subrow: Slider and Value (shown when active) -->
                                            <Border x:Name="Node6Subrow"
                                                    Margin="20,0,0,0"
                                                    IsVisible="False">
                                                <StackPanel Orientation="Horizontal" Spacing="8">
                                                    <Slider x:Name="Node6Slider"
                                                            Minimum="0"
                                                            Maximum="1"
                                                            Value="0"
                                                            Width="200"
                                                            Height="32"
                                                            VerticalAlignment="Center"/>
                                                    <Border BorderBrush="Black"
                                                            BorderThickness="1"
                                                            CornerRadius="0"
                                                            Padding="4,2">
                                                        <TextBlock x:Name="Node6Value"
                                                                   Text="0.00"
                                                                   Foreground="#888888"
                                                                   FontSize="12"
                                                                   Width="50"
                                                                   TextAlignment="Center"
                                                                   VerticalAlignment="Center"/>
                                                    </Border>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Border>
                            
                            <ProgressBar x:Name="GlobalProgressBar" 
                                         Height="20" 
                                         Minimum="0" 
                                         Maximum="100" 
                                         Value="0"
                                         ShowProgressText="True"
                                         Foreground="#ff8c00"
                                         CornerRadius="0"/>
                            
                            <TextBlock Text="Shader Information" Foreground="White" FontSize="14"/>
                            <TextBlock x:Name="ShaderInfoText" Text="No shader loaded" Foreground="#cccccc" FontSize="14" TextWrapping="Wrap"/>
                            
                            
                            
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </TabItem>
            <TabItem Header="MIDI" Background="#1e1e1e" FontSize="14" Foreground="White"> 
                <Border BorderBrush="Pink" BorderThickness="1" Background="#2d2d2d" Margin="-10, 0, -10, 0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                    <ScrollViewer Margin="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <StackPanel Spacing="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">

                            <!-- MIDI Devices Box -->
                            <Border BorderBrush="Black" BorderThickness="1" Padding="4">
                                <StackPanel Spacing="6">
                                    <TextBlock Text="MIDI Devices" Foreground="White" FontSize="14"/>
                                    <ListBox x:Name="MidiDevicesList"
                                             Height="100"
                                             Background="DarkGray"
                                             Foreground="Black"
                                             BorderBrush="Black"
                                             BorderThickness="1"
                                             CornerRadius="0">
                                        <ListBox.Styles>
                                            <Style Selector="ListBoxItem">
                                                <Setter Property="Height" Value="20"/>
                                                <Setter Property="Padding" Value="4,0"/>
                                            </Style>
                                        </ListBox.Styles>
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding}"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Left"
                                                           TextTrimming="CharacterEllipsis"/>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                    <TextBlock Text="Incoming MIDI" Foreground="White" FontSize="14"/>
                                    <ListBox x:Name="MidiInEventsList"
                                             Height="100"
                                             Background="DarkGray"
                                             Foreground="Black"
                                             BorderBrush="Black"
                                             BorderThickness="1"
                                             CornerRadius="0">
                                        <ListBox.Styles>
                                            <Style Selector="ListBoxItem">
                                                <Setter Property="Height" Value="20"/>
                                                <Setter Property="Padding" Value="4,0"/>
                                            </Style>
                                        </ListBox.Styles>
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding}"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Left"
                                                           TextTrimming="CharacterEllipsis"/>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </TabItem>


        </TabControl>
    </Grid>
    
    <!-- Bottom Log Popup Panel -->
    <Border x:Name="LogPopupPanel" 
            Grid.RowSpan="4" 
            Grid.ColumnSpan="3"
            Background="#2d2d2d" 
            BorderBrush="#555555"
            BorderThickness="0,2,0,0"
            IsVisible="False"
            VerticalAlignment="Bottom"
            Height="220"
            ClipToBounds="False">
        <Grid Background="#1e1e1e">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <StackPanel Orientation="Horizontal" Spacing="8" Margin="8,4" Grid.Row="0">
                <TextBlock Text="Debug Log" Foreground="White" VerticalAlignment="Center"/>
                <Button x:Name="ClearLogButton" Content="Clear" Width="60" Height="30" FontSize="12"/>
                <Button x:Name="CopyLogButton" Content="Copy" Width="60" Height="30" FontSize="12"/>
            </StackPanel>
            
            <ScrollViewer Grid.Row="1" Margin="8,0,8,8" x:Name="LogScrollViewer">
                <TextBlock x:Name="LogTextBox" 
                           Background="Transparent" 
                           Foreground="White" 
                           TextWrapping="Wrap"
                           FontFamily="Consolas"
                           FontSize="12"/>
            </ScrollViewer>
        </Grid>
    </Border>
  </Grid>
</Window>
